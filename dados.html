<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>DashControl Business - Dados</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
  <style>
    body { margin:0; font-family:'Poppins', sans-serif; background:#0d0d0d; color:white; }
    header { background:linear-gradient(90deg,#8e44ad,#b8860b); padding:15px; font-size:22px; font-weight:700; text-align:center; }
    h2 { color:#d4af37; margin:20px 0; text-align:center; }
    section { background:#1a1a1a; padding:20px; margin:20px auto; border-radius:12px; max-width:900px; box-shadow:0 4px 20px rgba(0,0,0,0.6); }
    label { display:block; margin:10px 0 5px; font-weight:600; color:#d4af37; }
    input, select { padding:10px; border-radius:6px; border:none; width:100%; background:#2c2c2c; color:white; font-size:14px; }
    .actions { text-align:center; margin-top:15px; }
    button { background:#8e44ad; padding:12px 20px; margin:8px; border:none; border-radius:8px; color:white; font-weight:bold; cursor:pointer; transition:0.3s; }
    button:hover { background:#b8860b; transform:scale(1.05); }
    .row { display:flex; flex-wrap:wrap; gap:15px; }
    .col { flex:1; min-width:200px; }
  </style>
</head>
<body>

<header>âš™ï¸ DashControl Business - InserÃ§Ã£o de Dados</header>

<!-- SeleÃ§Ã£o do tipo de negÃ³cio -->
<section>
  <h2>Escolha o tipo de negÃ³cio</h2>
  <select id="tipoNegocio" onchange="atualizarNegocio()">
    <option value="">-- Selecione --</option>
    <option value="delivery">ğŸšš Delivery</option>
    <option value="salao">ğŸ’‡â€â™€ï¸ SalÃ£o</option>
    <option value="ecommerce">ğŸ›’ E-commerce</option>
    <option value="academia">ğŸ¥‹ Academia</option>
  </select>
</section>

<!-- SessÃ£o Cliente -->
<section id="secCliente" style="display:none;">
  <h2>ğŸ‘¤ Cliente</h2>
  <label>Nome do Cliente:</label>
  <input type="text" id="clienteNome">
  <label>ServiÃ§o/Produto:</label>
  <input type="text" id="clienteServico" placeholder="Ex: Unha, Refrigerante, Jiu-Jitsu">
  <label>Valor (R$):</label>
  <input type="number" id="clienteValor">
  <label>Forma de Pagamento:</label>
  <select id="clientePagamento">
    <option value="Dinheiro">ğŸ’µ Dinheiro</option>
    <option value="Pix">âš¡ Pix</option>
    <option value="DÃ©bito">ğŸ’³ DÃ©bito</option>
    <option value="CrÃ©dito">ğŸ’³ CrÃ©dito</option>
  </select>
  <div class="actions">
    <button onclick="registrarCliente()">ğŸ’¾ Registrar Cliente</button>
  </div>
</section>

<!-- SessÃ£o Estoque -->
<section id="secEstoque" style="display:none;">
  <h2>ğŸ“¦ Estoque</h2>
  <div class="row">
    <div class="col">
      <label>Produto/ServiÃ§o:</label>
      <input type="text" id="estoqueProduto">
    </div>
    <div class="col">
      <label>Quantidade:</label>
      <input type="number" id="estoqueQtd">
    </div>
    <div class="col">
      <label>PreÃ§o UnitÃ¡rio (R$):</label>
      <input type="number" id="estoquePreco">
    </div>
  </div>
  <div class="actions">
    <button onclick="adicionarEstoque()">â• Adicionar</button>
    <button onclick="editarEstoque()">âœï¸ Editar</button>
    <button onclick="removerEstoque()">ğŸ—‘ï¸ Remover</button>
  </div>
</section>

<!-- SessÃ£o Financeiro -->
<section id="secFinanceiro" style="display:none;">
  <h2>ğŸ’° Financeiro</h2>
  <label>Caixa Inicial do Dia (R$):</label>
  <input type="number" id="caixaInicial">
  <div class="actions">
    <button onclick="atualizarCaixa()">ğŸ’¾ Atualizar Caixa</button>
  </div>
  <div class="row">
    <div class="col"><strong>Entradas:</strong> <span id="finEntradas">0</span></div>
    <div class="col"><strong>SaÃ­das:</strong> <span id="finSaidas">0</span></div>
    <div class="col"><strong>Saldo Atual:</strong> <span id="finSaldo">0</span></div>
  </div>
</section>

<!-- BotÃµes gerais -->
<section id="secAcoes" style="display:none;">
  <h2>âš¡ AÃ§Ãµes</h2>
  <div class="actions">
    <button onclick="exportarCSV()">â¬‡ Exportar CSV</button>
    <button onclick="limparDados()">ğŸ—‘ï¸ Limpar Todos os Dados</button>
  </div>
</section>

<script>
let dados = JSON.parse(localStorage.getItem("dashBusiness")) || {delivery:[], salao:[], ecommerce:[], academia:[]};
let negocioAtual="";

// Atualizar tipo de negÃ³cio
function atualizarNegocio(){
  negocioAtual=document.getElementById("tipoNegocio").value;
  if(negocioAtual){
    document.getElementById("secCliente").style.display="block";
    document.getElementById("secEstoque").style.display="block";
    document.getElementById("secFinanceiro").style.display="block";
    document.getElementById("secAcoes").style.display="block";
  }
}

// Registrar Cliente (gera venda, desconta estoque, atualiza financeiro)
function registrarCliente(){
  let nome=document.getElementById("clienteNome").value;
  let servico=document.getElementById("clienteServico").value;
  let valor=parseFloat(document.getElementById("clienteValor").value)||0;
  let pagamento=document.getElementById("clientePagamento").value;

  if(!nome || !servico || !valor){ alert("Preencha todos os campos do cliente!"); return; }

  // desconto do estoque
  let item=dados[negocioAtual].find(p=>p.produto===servico);
  if(item){
    if(item.quantidade>0){ item.quantidade--; }
    else{ alert("âŒ Estoque insuficiente!"); return; }
  }

  // salvar venda no array
  let registro={tipo:"cliente", nome, servico, valor, pagamento, data:new Date().toLocaleDateString()};
  dados[negocioAtual].push(registro);

  // atualizar financeiro
  atualizarFinanceiro(valor,0);

  salvarLocal();
  alert("âœ… Cliente registrado com sucesso!");
  document.getElementById("clienteNome").value="";
  document.getElementById("clienteServico").value="";
  document.getElementById("clienteValor").value="";
}

// Estoque
function adicionarEstoque(){
  let produto=document.getElementById("estoqueProduto").value;
  let quantidade=parseInt(document.getElementById("estoqueQtd").value)||0;
  let preco=parseFloat(document.getElementById("estoquePreco").value)||0;
  if(!produto || quantidade<=0 || preco<=0){ alert("Preencha todos os campos do estoque!"); return; }
  dados[negocioAtual].push({tipo:"estoque", produto, quantidade, preco});
  salvarLocal();
  alert("âœ… Produto adicionado ao estoque!");
}
function editarEstoque(){
  let produto=document.getElementById("estoqueProduto").value;
  let item=dados[negocioAtual].find(p=>p.produto===produto && p.tipo==="estoque");
  if(item){
    item.quantidade=parseInt(document.getElementById("estoqueQtd").value)||item.quantidade;
    item.preco=parseFloat(document.getElementById("estoquePreco").value)||item.preco;
    salvarLocal();
    alert("âœï¸ Produto atualizado!");
  } else alert("âŒ Produto nÃ£o encontrado no estoque!");
}
function removerEstoque(){
  let produto=document.getElementById("estoqueProduto").value;
  dados[negocioAtual]=dados[negocioAtual].filter(p=>!(p.produto===produto && p.tipo==="estoque"));
  salvarLocal();
  alert("ğŸ—‘ï¸ Produto removido do estoque!");
}

// Financeiro
function atualizarCaixa(){
  let inicial=parseFloat(document.getElementById("caixaInicial").value)||0;
  dados[negocioAtual].push({tipo:"caixa", inicial, data:new Date().toLocaleDateString()});
  salvarLocal();
  alert("âœ… Caixa inicial atualizado!");
}
function atualizarFinanceiro(entrada,saida){
  let entradas=entrada||0;
  let saidas=saida||0;
  let saldoAtual=parseFloat(document.getElementById("finSaldo").innerText)||0;
  saldoAtual=saldoAtual+entradas-saidas;
  document.getElementById("finEntradas").innerText=(parseFloat(document.getElementById("finEntradas").innerText)||0)+entradas;
  document.getElementById("finSaidas").innerText=(parseFloat(document.getElementById("finSaidas").innerText)||0)+saidas;
  document.getElementById("finSaldo").innerText=saldoAtual;
}

// Salvar LocalStorage
function salvarLocal(){ localStorage.setItem("dashBusiness", JSON.stringify(dados)); }

// Limpar
function limparDados(){
  if(confirm("Deseja apagar todos os dados?")){
    dados={delivery:[], salao:[], ecommerce:[], academia:[]};
    salvarLocal();
    alert("ğŸ—‘ï¸ Dados apagados!");
  }
}

// Exportar CSV
function exportarCSV(){
  let registros=dados[negocioAtual];
  if(registros.length===0){ alert("Nenhum dado para exportar!"); return; }
  let csv=Object.keys(registros[0]).join(",")+"\n";
  registros.forEach(r=>{ csv+=Object.values(r).join(",")+"\n"; });
  let blob=new Blob([csv],{type:"text/csv"});
  let url=URL.createObjectURL(blob);
  let a=document.createElement("a");
  a.href=url;
  a.download=`${negocioAtual}_dados.csv`;
  a.click();
}
</script>

</body>
</html>